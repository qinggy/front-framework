$(function () {
  // #region field area
  let subscribeModuleList = [];

  //#endregion
  let fetchSubscribeModule = () => {
    // fetch navigate data from db
    subscribeModuleList = [{
      name: '首页',
      icon: 'icon-yemian-copy-copy',
      uri: '',
      index: 0,
      isDefault: true
    }, {
      name: '设备监测',
      icon: 'icon-shuju2',
      uri: '',
      index: 1,
      isDefault: false
    }, {
      name: '用量分析',
      icon: 'icon-shuju3',
      uri: 'http://172.17.0.48/analysisapp/src/statistics/index.html',
      index: 2,
      isDefault: false
    }, {
      name: '用量报表',
      icon: 'icon-xinjianwenbenwendang',
      uri: '',
      index: 3,
      isDefault: false
    }, {
      name: '健康',
      icon: 'icon-security',
      uri: '',
      index: 4,
      isDefault: false
    }, {
      name: '设置',
      icon: 'icon-shezhi',
      uri: '',
      index: 5,
      isDefault: false
    }];
    subscribeModuleList = _.orderBy(subscribeModuleList, a => a.index, 'asc');
    let navigateHtml = template('navigation-item-template', {
      subscribeModuleList
    });
    $('#navigation-content').html(navigateHtml);
    setTimeout(() => {
      $('.out-tab ul li').off('click').on('click', function (e) {
        e.stopPropagation();
        let currentDom = $(e.currentTarget);
        let uri = currentDom.attr('data-uri');
        let moduleName = currentDom.attr('data-name');
        $('.out-tab ul li').removeClass('nav-selected');
        currentDom.addClass('nav-selected');
        $('#contentIframe').attr('src', uri);
        $('.head-title>div').text(moduleName);
      });
      $('.out-tab ul li.nav-selected').click();
    }, 300);
  };

  let bindingDashboardComponents = () => {
    $('.user-select div').off('click').on('click', function (e) {
      let currentDom = $(e.currentTarget);
      let dataId = currentDom.attr('data-id');
      switch (dataId) {
        case 'user':
          break;
        case 'logout':
          //sessionStorage.
          window.location.href = 'login.html';
          break;
      }
    });
  };

  bindingDashboardComponents();
  fetchSubscribeModule();
});